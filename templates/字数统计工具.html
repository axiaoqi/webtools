{% extends 'base.html' %}

{% block title %}在线字数统计工具{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <h2 class="text-center mb-4">在线字数统计</h2>

            <!-- ================== 使用标准表单布局 ================== -->
            <div class="mb-3">
                <label for="content" class="form-label">在这里输入或粘贴内容...</label>
                <textarea class="form-control" id="content" rows="10" autofocus></textarea>
            </div>
            <!-- ==================================================== -->

            <!-- 使用 Bootstrap 的按钮 -->
            <div class="text-end mb-4">
                <button class="btn btn-warning btn-sm" onclick="resetForm()">清空内容</button>
            </div>

            <!-- 使用 Bootstrap 的徽章 (Badges) 来显示统计结果 -->
            <h5>统计结果:</h5>
            <div class="d-flex flex-wrap gap-2">
                <span class="badge bg-primary fs-6">总字数: <span id="zishu">0</span></span>
                <span class="badge bg-secondary fs-6">总字符: <span id="zifu">0</span></span>
                <span class="badge bg-success fs-6">汉字: <span id="hanzi">0</span></span>
                <span class="badge bg-danger fs-6">标点(全角): <span id="biaodian">0</span></span>
                <span class="badge bg-info text-dark fs-6">字母: <span id="zimu">0</span></span>
                <span class="badge bg-warning text-dark fs-6">数字: <span id="shuzi">0</span></span>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{# JavaScript 逻辑完全保持不变，因为它是通过 id 来操作元素的 #}
<script type="text/javascript">
    function $(id) { return document.getElementById(id); }

    var EventUtil = {
        addEventHandler: function (obj, EventType, Handler) {
            obj.addEventListener(EventType, Handler, false);
        }
    };

    if ($("content")) {
        EventUtil.addEventHandler($('content'), 'input', CountChineseCharacters);
        CountChineseCharacters();
    }

    function CountChineseCharacters() {
        var Words = $('content').value;
        var iTotal = (Words.match(/[\u4e00-\u9fa5]/g) || []).length;
        var sTotal = (Words.match(/[^\x00-\xff]/g) || []).length;
        var inum = (Words.match(/[0-9]/g) || []).length;
        var eTotal = (Words.match(/[a-zA-Z]/g) || []).length;

        $('hanzi').innerText = iTotal;
        $('biaodian').innerText = sTotal - iTotal;
        $('zimu').innerText = eTotal;
        $('shuzi').innerText = inum;
        $('zishu').innerText = iTotal + eTotal + inum;
        var halfWidthChars = Words.length - sTotal;
        $('zifu').innerText = sTotal * 2 + halfWidthChars;
    }

    function resetForm() {
        $('content').value = "";
        CountChineseCharacters();
    }
</script>
{% endblock %}